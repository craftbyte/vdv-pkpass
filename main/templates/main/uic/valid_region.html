{% load tz rics %}
<dl class="govuk-summary-list">
    {% for region in valid_region %}
        {% if region.0 == "trainLink" %}
            <div class="govuk-summary-card">
                <div class="govuk-summary-card__title-wrapper">
                    <h2 class="govuk-summary-card__title">
                        Train {% if region.1.trainIA5 %}{{ region.1.trainIA5 }}{% elif region.1.trainNum %}{{ region.1.trainNum }}{% endif %}
                    </h2>
                </div>
                <div class="govuk-summary-card__content">
                    <dl class="govuk-summary-list">
                        {% if region.1.fromStationNum %}
                            <div class="govuk-summary-list__row">
                                <dt class="govuk-summary-list__key">From station number</dt>
                                <dd class="govuk-summary-list__value"><code>{{ region.1.fromStationNum }}</code>
                                </dd>
                            </div>
                        {% endif %}
                        {% if region.1.fromStationNameUTF8 %}
                            <div class="govuk-summary-list__row">
                                <dt class="govuk-summary-list__key">From station name</dt>
                                <dd class="govuk-summary-list__value">{{ region.1.fromStationNameUTF8 }}</dd>
                            </div>
                        {% endif %}
                        {% with station=region.1.fromStationNum|get_station:ticket %}
                            {% if station %}
                                <div class="govuk-summary-list__row">
                                    <dt class="govuk-summary-list__key">From station</dt>
                                    <dd class="govuk-summary-list__value">
                                        {% include "main/uic/station.html" with station=station %}
                                    </dd>
                                </div>
                            {% endif %}
                        {% endwith %}
                        {% if region.1.toStationNum %}
                            <div class="govuk-summary-list__row">
                                <dt class="govuk-summary-list__key">To station number</dt>
                                <dd class="govuk-summary-list__value"><code>{{ region.1.toStationNum }}</code>
                                </dd>
                            </div>
                        {% endif %}
                        {% if region.1.toStationNameUTF8 %}
                            <div class="govuk-summary-list__row">
                                <dt class="govuk-summary-list__key">To station name</dt>
                                <dd class="govuk-summary-list__value">{{ region.1.toStationNameUTF8 }}</dd>
                            </div>
                        {% endif %}
                        {% with station=region.1.toStationNum|get_station:ticket %}
                            {% if station %}
                                <div class="govuk-summary-list__row">
                                    <dt class="govuk-summary-list__key">To station</dt>
                                    <dd class="govuk-summary-list__value">
                                        {% include "main/uic/station.html" with station=station %}
                                    </dd>
                                </div>
                            {% endif %}
                        {% endwith %}
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Departure time</dt>
                            <dd class="govuk-summary-list__value">
                                {{ region.1|rics_departure_time:flex.issuing_time|utc|date:"F d, Y H:i" }} UTC
                            </dd>
                        </div>
                    </dl>
                </div>
            </div>
        {% elif region.0 == "zones" %}
            <div class="govuk-summary-card">
                <div class="govuk-summary-card__title-wrapper">
                    <h2 class="govuk-summary-card__title">
                        Zone
                    </h2>
                </div>
                <div class="govuk-summary-card__content">
                    <dl class="govuk-summary-list">
                        {% if region.1.nutsCode %}
                            <div class="govuk-summary-list__row">
                                <dt class="govuk-summary-list__key">NUTS Region</dt>
                                <dd class="govuk-summary-list__value">{{ region.1.nutsCode|nuts_region_name }}</dd>
                            </div>
                        {% endif %}
                    </dl>
                </div>
            </div>
        {% else %}
            <div class="govuk-summary-card">
                <div class="govuk-summary-card__title-wrapper">
                    <h2 class="govuk-summary-card__title">
                        Unknown region - <code>{{ region.0 }}</code>
                    </h2>
                </div>
                <div class="govuk-summary-card__content">
                    <pre>{{ region.1|pprint }}</pre>
                </div>
            </div>
        {% endif %}
    {% endfor %}
</dl>